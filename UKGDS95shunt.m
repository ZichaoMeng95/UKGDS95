function mpc = UKGDS95shunt
%%
% This is the case file for united kingdom genertic distribution system 95-bus system
% with non-zero line shunts
%
%
%   Data from ...
%       F. U. Nazir, B. C. Pal, and R. A. Jabr, “A two-stage chance constrained
%       volt/var control scheme for active distribution networks with nodal power
%       uncertainties," IEEE Transactions on Power Systems, vol. 34, no. 1,pp. 314C325, 2019.
%
% 
%
%   Also in ...
%       Lin H, Ul Nazir F, Pal BC, Guo Y. A linearized branch flow model considering
%       line shunts for radial distribution systems and its application in Volt/VAr control.
%       Journal of Modern Power System and Clean Energy 2023;11(4):1191C200. http://dx.doi.org/10.35833/MPCE.2022.000382.
%
%   Please cite these two papers if you use this m.file
%%

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 10;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [
1,3,0,0,0,0,1,1,0,12.6600000000000,1,1,1;2,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;3,1,4.54600000000000,0.647800000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;4,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;5,1,13.4630000000000,3.54710000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;6,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;7,1,16.4072000000000,4.73210000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;8,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;9,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;10,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;11,1,1.51530000000000,0.215900000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;12,1,1.51690000000000,0.216200000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;13,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;14,1,7.17960000000000,1.45050000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;15,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;16,1,5.94680000000000,1.66720000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;17,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;18,1,120,2,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;19,1,58.0464000000000,11.7868000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;20,1,10.2870000000000,3.38120000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;21,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;22,1,9.10080000000000,1.29690000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;23,1,9.95340000000000,2.42560000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;24,1,24.4924000000000,5.67460000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;25,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;26,1,27.5256000000000,9.54440000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;27,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;28,1,10.2414000000000,3.33440000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;29,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;30,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;31,1,12.8588000000000,4.22650000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;32,1,27.3241000000000,8.40620000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;33,1,7.57670000000000,1.07960000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;34,1,9.95340000000000,2.42560000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;35,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;36,1,25.3431000000000,6.22560000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;37,1,12.5177000000000,4.24320000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;38,1,5.14350000000000,1.69060000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;39,1,7.71530000000000,2.53590000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;40,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;41,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;42,1,12.2209000000000,2.69110000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;43,1,20.4829000000000,6.66880000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;44,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;45,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;46,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;47,1,4.54600000000000,0.647800000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;48,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;49,1,9.31610000000000,3.10500000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;50,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;51,1,12.2209000000000,2.69110000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;52,1,28.2256000000000,10.8563000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;53,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;54,1,9.95340000000000,2.22220000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;55,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;56,1,2.42450000000000,0.345500000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;57,1,2.72760000000000,0.388700000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;58,1,5.14350000000000,1.69060000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;59,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;60,1,4.54600000000000,0.647800000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;61,1,4.54600000000000,0.647800000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;62,1,12.5120000000000,5.63760000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;63,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;64,1,9.43020000000000,2.41700000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;65,1,9.09200000000000,1.29550000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;66,1,15.8870000000000,5.68090000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;67,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;68,1,10.6073000000000,1.51150000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;69,1,4.24290000000000,0.604600000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;70,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;71,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;72,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;73,1,3.93990000000000,0.561400000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;74,1,35.4766000000000,10.8329000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;75,1,3.03070000000000,0.431800000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;76,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;77,1,1.51530000000000,0.215900000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;78,1,3.63680000000000,0.518200000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;79,1,18.8604000000000,4.80530000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;80,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;81,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;82,1,24.3948000000000,9.05880000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;83,1,1.51530000000000,0.215900000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;84,1,5.38700000000000,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;85,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;86,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;87,1,49.8745000000000,13.4733000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;88,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;89,1,45.0662000000000,10.9343000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;90,1,25.1395000000000,5.32110000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;91,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;92,1,76.6899000000000,35.3841000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;93,1,0,0,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;94,1,32.8144000000000,9.46420000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000;95,1,2.68000000000000,1.37000000000000,0,0,1,1,0,12.6600000000000,1,1.10000000000000,0.900000000000000
];
%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [
	1	0	0	999	-999	1	100	1	10	0	0	0	0	0	0	0	0	0	0	0	0;
];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [  %% (r and x specified in ohms here, converted to p.u. below)
  1      2       0.04879   0.05058  0	0	0	0	0	0	1	-360	360;   
  1      85      0.05489   0.05690  0	0	0	0	0	0	1	-360	360;
  2      4       0.09755   0.33284  0	0	0	0	0	0	1	-360	360; 
  3      4       0.17322   0.07589  0	0	0	0	0	0	1	-360	360; 
  4      6       0.21000   0.20300  0	0	0	0	0	0	1	-360	360; 
  5      6       0.24251   0.10624  0	0	0	0	0	0	1	-360	360; 
  6      8       0.25860   0.17673  0	0	0	0	0	0	1	-360	360;  
  7      8       0.34645   0.15178  0	0	0	0	0	0	1	-360	360;  
  8      10      0.12930   0.08836  0	0	0	0	0	0	1	-360	360;
  9      10      0.29500   0.15000  0	0	0	0	0	0	1	-360	360;
  9      28      0.20787   0.09107   0	0	0	0	0	0	1	-360	360;
  9      29      0.35400   0.18000  0	0	0	0	0	0	1	-360	360; 
  10     11      0.30169   0.20618  0	0	0	0	0	0	1	-360	360; 
  11     13      0.19395   0.13255  0	0	0	0	0	0	1	-360	360;
  12     13      0.17322   0.07589  0	0	0	0	0	0	1	-360	360;
  13     15      0.23705   0.16200  0	0	0	0	0	0	1	-360	360;
  14     15      0.20787   0.09107  0	0	0	0	0	0	1	-360	360; 
  15     17      0.25860   0.17673  0	0	0	0	0	0	1	-360	360; 
  16     17      0.13858   0.06071  0	0	0	0	0	0	1	-360	360; 
  17     25      0.12930   0.08836   0	0	0	0	0	0	1	-360	360; 
  18     19      0.12000   0.11600  0	0	0	0	0	0	1	-360	360; 
  19     21      0.36000   0.34800  0	0	0	0	0	0	1	-360	360;
  20     21      0.13161   0.05033  0	0	0	0	0	0	1	-360	360;
  21     22      0.09000   0.08700  0	0	0	0	0	0	1	-360	360;
  22     23      0.30169   0.20618  0	0	0	0	0	0	1	-360	360;
  23     24      0.19395   0.13255  0	0	0	0	0	0	1	-360	360;
  24     25      0.21550   0.14727  0	0	0	0	0	0	1	-360	360;
  25     27      0.17240   0.11782  0	0	0	0	0	0	1	-360	360;
  26     27      0.10775   0.07364  0	0	0	0	0	0	1	-360	360;
  29     30      0.27716   0.12142  0	0	0	0	0	0	1	-360	360; 
  29     31      0.24251   0.10624  0	0	0	0	0	0	1	-360	360;  
  30     32      0.25860   0.17673  0	0	0	0	0	0	1	-360	360;  
  30     34      0.11149   0.07376  0	0	0	0	0	0	1	-360	360; 
  32     33      0.31180   0.13660  0	0	0	0	0	0	1	-360	360; 
  34     35      0.34612   0.20653  0	0	0	0	0	0	1	-360	360; 
  35     36      0.15608   0.10326  0	0	0	0	0	0	1	-360	360;  
  35     39      0.34479   0.23564  0	0	0	0	0	0	1	-360	360; 
  36     37      0.22298   0.14752  0	0	0	0	0	0	1	-360	360; 
  37     38      0.21350   0.09126  0	0	0	0	0	0	1	-360	360;  
  39     40      0.12930   0.08836  0	0	0	0	0	0	1	-360	360; 
  40     41      0.11800   0.06000  0	0	0	0	0	0	1	-360	360; 
  40     53      0.17240   0.11782  0	0	0	0	0	0	1	-360	360;
  41     42      0.20787   0.09107  0	0	0	0	0	0	1	-360	360; 
  41     43      0.23600   0.12000  0	0	0	0	0	0	1	-360	360; 
  43     44      0.17700   0.09000  0	0	0	0	0	0	1	-360	360;
  44     45      0.09401   0.03595  0	0	0	0	0	0	1	-360	360;
  45     46      0.17700   0.09000  0	0	0	0	0	0	1	-360	360; 
  46     47      0.23600   0.12000  0	0	0	0	0	0	1	-360	360;
  46     48      0.35400   0.18000  0	0	0	0	0	0	1	-360	360; 
  48     49      0.35400   0.18000  0	0	0	0	0	0	1	-360	360; 
  48     50      0.27716   0.12142  0	0	0	0	0	0	1	-360	360; 
  50     51      0.21350   0.09126  0	0	0	0	0	0	1	-360	360; 
  50     52      0.53374   0.22816  0	0	0	0	0	0	1	-360	360;  
  53     54      0.30169   0.20618  0	0	0	0	0	0	1	-360	360;
  53     55      0.20787   0.09107  0	0	0	0	0	0	1	-360	360; 
  54     59      0.36517   0.15244  0	0	0	0	0	0	1	-360	360; 
  54     75      0.25860   0.17673  0	0	0	0	0	0	1	-360	360;
  55     56      0.27716   0.12142  0	0	0	0	0	0	1	-360	360; 
  55     57      0.41574   0.18213  0	0	0	0	0	0	1	-360	360; 
  57     58      0.27716   0.12142  0	0	0	0	0	0	1	-360	360;
  59     60      0.17322   0.07589  0	0	0	0	0	0	1	-360	360; 
  59     62      0.14607   0.06098  0	0	0	0	0	0	1	-360	360;
  60     61      0.31180   0.13660  0	0	0	0	0	0	1	-360	360;
  62     63      0.25562   0.10671  0	0	0	0	0	0	1	-360	360;
  63     64      0.20787   0.09107  0	0	0	0	0	0	1	-360	360;
  63     65      0.18258   0.07622  0	0	0	0	0	0	1	-360	360;
  65     66      0.29213   0.12195  0	0	0	0	0	0	1	-360	360;
  66     67      0.25562   0.10671 0	0	0	0	0	0	1	-360	360;
  67     68      0.09401   0.03595  0	0	0	0	0	0	1	-360	360;
  67     69      0.43820   0.18293 0	0	0	0	0	0	1	-360	360;
  69     70      0.21910   0.09146  0	0	0	0	0	0	1	-360	360;
  70     71      0.07521   0.02876  0	0	0	0	0	0	1	-360	360;
  71     72      0.14607   0.06098  0	0	0	0	0	0	1	-360	360;
  72     73      0.29213   0.12195  0	0	0	0	0	0	1	-360	360;
  72     74      0.40168   0.16768 0	0	0	0	0	0	1	-360	360;
  75     76      0.12930   0.08836 0	0	0	0	0	0	1	-360	360;
  76     77      0.18258   0.07622  0	0	0	0	0	0	1	-360	360;
  76     80      0.21550   0.14727   0	0	0	0	0	0	1	-360	360;
  77     78      0.29213   0.12195   0	0	0	0	0	0	1	-360	360;
  78     79      0.43820   0.17673  0	0	0	0	0	0	1	-360	360;
  80     83      0.12930   0.08836  0	0	0	0	0	0	1	-360	360;
  80     86      0.19395   0.13255  0	0	0	0	0	0	1	-360	360;
  81     82      0.27244   0.04012  0	0	0	0	0	0	1	-360	360;
  81     94      0.15085   0.10309   0	0	0	0	0	0	1	-360	360;
  82     95      0.49039   0.07222    0	0	0	0	0	0	1	-360	360;
  84     85      0.03881   0.10400   0	0	0	0	0	0	1	-360	360;
  86     87      0.27716   0.12142  0	0	0	0	0	0	1	-360	360;  
  86     90      0.25860   0.17673  0	0	0	0	0	0	1	-360	360; 
  87     88      0.48502   0.21249  0	0	0	0	0	0	1	-360	360; 
  88     89      0.22621   0.04686  0	0	0	0	0	0	1	-360	360; 
  90     91      0.06465   0.04418  0	0	0	0	0	0	1	-360	360;  
  91     92      0.27244   0.04012  0	0	0	0	0	0	1	-360	360;  
  92     93      0.16346   0.02407   0	0	0	0	0	0	1	-360	360;
  93     94      0.08620   0.05891  0	0	0	0	0	0	1	-360	360;
];

%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0	20	0;
];


%% convert branch impedances from Ohms to p.u.
[PQ, PV, REF, NONE, BUS_I, BUS_TYPE, PD, QD, GS, BS, BUS_AREA, VM, ...
    VA, BASE_KV, ZONE, VMAX, VMIN, LAM_P, LAM_Q, MU_VMAX, MU_VMIN] = idx_bus;
[F_BUS, T_BUS, BR_R, BR_X, BR_B, RATE_A, RATE_B, RATE_C, ...
    TAP, SHIFT, BR_STATUS, PF, QF, PT, QT, MU_SF, MU_ST, ...
    ANGMIN, ANGMAX, MU_ANGMIN, MU_ANGMAX] = idx_brch;
Vbase = mpc.bus(1, BASE_KV) * 1e3;      %% in Volts
Sbase = mpc.baseMVA * 1e6;              %% in VA
mpc.branch(:, [BR_R BR_X]) = mpc.branch(:, [BR_R BR_X]) / (Vbase^2 / Sbase);

%% convert loads from kW to MW
mpc.bus(:, [PD, QD]) = mpc.bus(:, [PD, QD]) / 1e3;

%% Scenario based 
T=1000;
mpc.pload=zeros(94,T);
mpc.qload=zeros(94,T);
errorP=normrnd(0,0.005,[94 T]);
for t=1:T
    mpc.pload(:,t)=mpc.bus(:,3)+errorP(:,t);
    mpc.qload(:,t)=mpc.bus(:,4)+errorP(:,t);
end

%% DG
%Bus	ActivePower Loss (MW)	ReactivePower (MVar)
%% 计及分布式电源
%Bus	ActivePower (MW)	Power factor (lag)
mpc.DGdata = [
    28	0.3 5 0.05 10 0 0.2 0 0.1 0 0 0.02 5; 
    61  0.3 5 0.04 9 0 0.3 0 0.1 0.7 0.7 0 0;
    83  0.3 5 0.08 6 0 0.3 0 0.1 0.7 0.7 0 0;
    49  0.15 4.5 0.02 10 0 0.3 0 0.1 0.7 0.7 0 0;
    42  0.15 4.5 0.04 8 0 0.3 0 0.1 0.7 0.7 0 0;
    95  0.15 4.5 0.05 6 0 0.3 0 0.1 0.7 0.7 0 0;
];

mpc.Prodata=[
 28 0.35
 31 0.15
 33 0.16
 35 0.32
 46 0.45
 79 0.40
 83 0.45
 49 0.35
 13 0.27
 56 0.30
 61 0.32
 16 0.40
 42 0.45
 84 0.42
 77 0.44
 26 0.32
 95 0.18
 90 0.48
    ];

mpc.RESdata = [
    7	1.3  0.6
    9  1.4  0.5
    16  1.5  0.7
    31 1.5  0.5
    84 1.6  0.9
    77 1.7  0.5
    26 1.8  0.8
];
               %有功功率

DGdata = mpc.DGdata;
ConsiderDG = 1; %是否计及分布式电源：1是；0否
switch ConsiderDG
    case 1
        for i=1:length(DGdata(:,1))
            mpc.bus(DGdata(i,1),3) = mpc.bus(DGdata(i,1),3)-0.1; %有功功率
%             ReactivePower =  DGdata(i,3);                          %功率因素
%             mpc.bus(DGdata(i,1),4) = mpc.bus(DGdata(i,1),4)-ReactivePower;  %无功功率
        end
    case 0
end
%% Cap
%Bus	ActivePower Loss (MW)	ReactivePower (MVar)
mpc.CAPdata = [
    7	0.1	 0.02
    9  0.1  0.03
    16  0.1  0.05
];

CAPdata = mpc.CAPdata;
ConsiderCAP = 1; %是否计及分布式电源：1是；0否
switch ConsiderCAP
    case 1
        for i=1:length(CAPdata(:,1))
            ActivePower = CAPdata(i,2);                 %有功功率
            mpc.bus(CAPdata(i,1),3) = mpc.bus(CAPdata(i,1),3)+ActivePower; %有功功率
%             ReactivePower =  CAPdata(i,3);                          %功率因素
%             mpc.bus(CAPdata(i,1),4) = mpc.bus(CAPdata(i,1),4)-ReactivePower;  %无功功率
        end
    case 0
end